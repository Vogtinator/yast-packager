<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
<head>
  <title>YaST2 Package Installation</title>
</head>
<body bgcolor="white" text="black" link="blue" alink="red" vlink="maroon">


<h2>YaST2 Package Installation</h2>

<h3>1.New installation</h3><br>
     This chapter describes the part concerning the package selection on completely new installation of SuSE Linux.
        <ol>
         <li><a href="#Overview new installation">Overview new istallation</a></li>
         <li>Description of ycp modules</li>
         <ul>
           <li><a href="#Software Selection"> Software Selection( <u>inst_sw_select.ycp</u> )</a></li>
           <li><a href="#Detailed Selection"> Detailed Selection( <u>inst_sw_details.ycp</u> )</a></li>
           <li><a href="#Single new install"> Single Software Selection( <u>inst_sw_single.ycp</u> )</a></li>
         </ul>
        </ol>

<h3>2. Remove or install packages in installed system</h3><br>
      The package installation is called from YaST2 Controil Center. The user can install additional 
      packages or remove installed ones from the system.
   <ol>
         <li><a href="#Overview installed system">Overview data flow</a></li>
         <li>Description of ycp modules</li>
         <ul>
           <li><a href="#Control module">Control module ( <u>sw_single.ycp</u> )</a></li>
           <li><a href="#Single post install">Single Software Selection ( <u>inst_sw_single.ycp</u> )</a></li>
       </ul>
   </ol>

<h3>3. Update</h3><br>
    This document only decribes the issues concerning the module inst_sw_single.ycp</u>. A complete documenation
    for YaST2 Update can be found at ............
           <li><a href="#Single update mode">Update Single Selection ( <u>inst_sw_single.ycp</u> )</a></li>
       </ul>
   </ol>



<h3>1. New installation</h3>

<h4><a name="Overview new installation">1.1. Overview new installation</a></h4>

<img src="overview_new_inst.png">

<hr>

<p>
The diagramm shows three sections. Left side describes the <b>Source</b> i.e. where the information
about the packages and the rpm's itself comes from. 
The middle part represents <b>YaST2</b> modules involved in package installation.
The <b>Target</b>, (the partition(s) on harddisk where the packages will be installed)
is shown on the right.
</p>

<h4>1.2. Description of ycp modules:</h4>

<h4><a name="Software Selection">Software Selection</a></h4>

<ol>
    <li><b>Description:</b>
        <p>
        This module displays the software selection screen, i.e. shows buttons
        for the main categories Minimal, Standard, Standard with Office and
        Almost Everthing.  There is also the possibility the select Kernel 2.2
        or Kernel 2.4.
	The button Detailed Selection leads to screen Detailed Software Selection
	( see <a href="#Detailed Selection"> Detailed Selection</a> ).
        </p>
    </li>
    <li><b>Main steps:</b></li>
     <ul>
        <li>Get information about available partitions
	   <p>
	   The information about the partitions which will be used for the installation are stored at
	   <b>targets</b> in <i>user_settings</i>. In test_mode the targets come from test_target_map.ycp.
	   </p>
	</li>
	<li>Initialize the package information agent
	   <p>
	   Parameters are the pathnames, where the packages, the descriptions and disk space info is located,
	   the language and the target partitions on harddisk. The package agent will do all work (checking dependencies,
	   calculating disk space ... ) concerning the packages.
	   </p>
	</li>
	<li>Check the required diskspace
	   <p>
	   Get information about the required space for actual selection from the package agent and show a popup
	   if there isn't enough space (as well as set an error status which forbids to go NEXT).
	   </p>
	 </li>
	 <li>Inform the package agent about current selection
	   <p>        
	   Call <u>inst_pkg_toinstall.ycp</u>, which calls package agent to get a list of all packages belonging to
	   current selection from *.sel files ( e.g. .../suse/setup/descr/Minimal.sel ).
	   Inform the package agent about that packages.
	   </p>
	 </li>
	 <li>Write the kernel selection to <i>user_settings</i></li>
     </ul>
    <li><b>Actions on NEXT:</b>    </li>
    <ul>
     <li>Check diskspace for wanted software selection
        <p>
	Write <b>needed_space</b> to <i>user_settings.</i>
	</p>
     </li>
     <li>Get information which packages should be installed
        <p>
        Call of package agent returns a list of packages with following informations:
	location of the package (subdirectory, e.g. a1), CD number and whether the
	package is a base package.
	This list is written as <b>install_list</b><i> to user_settings</i>.
	</p>
     </li>
     <li>Call <u>inst_add_pkg_toinstall.ycp</u>
       <p>
       This module adds additional required packages to <b>install_list</b>
       (depending on architecture and hardware).
       </p>
     </li>
    </ul>
</ol>


<h4><a name="Detailed Selection">Detailed Software Selection</a></h4>

<ol>
    <li><b>Description:</b>
       <p>
       This module displays the possibilty to choose categories of software, e.g. Games,
        KDE, development ... and to install the sources.
       Also shows buttons Commercial Software and Single Software Selection which lead to screen
       single software packages ( see <a href="#Single new install"> Single Software Selection</a>)
       </p>
    </li>
    <li><b>Main steps:</b> </li>
    <ul>
      <li>Inform the package agent about current selection of categories
	   <p>        
	   Call <u>inst_pkg_toinstall.ycp</u>, which calls the package agent to get a list of all packages belonging to
	   current selection from *.sel files, e.g.  ( e.g. .../suse/setup/descr/KDE.sel ).
	   The packages are added to the preselected packages from the main category.
	     </p>
	</li>
       <li>Inform the package agent about that packages. </li>

       <li><b>Actions on NEXT:</b>
         <p>
	 Returns to module <u>inst_sw_select.ycp</u>, which does the remaining work to get the install
	 packages and write <b>install_list</b><i> to user_settings</i>
	 (see <a href="#Software Selection">Software Selection</a>).
         </p>
      </li>
     </ul>
</ol>


<h4><a name="Single new install">Single Software Selection</a></h4>

<ol>
 <li><b>Description:</b>
        <p>
	This dialog is called from <a href="#Detailed Selection"> Detailed Selection</a> and shows
        a list of all package sets/groups and all packages belonging to the selected set/group.
	The user can select additional packages or deselect selected ones. The package agent
	checks the package dependencies, i.e. determines conflicting and additional
	required packages.
	The module is used for the Single Software Selection as well as the Commercial
	Software Selection screen. The module is called with special arguments to make it possible to
	 create a different layout and functionality for the particular requirements.
        </p>
    </li>
 <li><b>Calls of inst_sw_single:</b>
   <ul>
       <li>inst_sw_single   <b>`single</b>    <b>`only_check</b>
       <p>
       The module is only called to show unresolved dependencies from former selection
       in inst_sw_details and is closed afterwards.
       </p>
       </li>
       <li>inst_sw_single   <b>`single</b>    <b>`not_only_checked</b>
       <p>
       The Single Software Selection screen is opened and the user can do the selections.
       </p>
       </li>
       <li>inst_sw_single   <b>`pay</b>     <b>`not_only_checked</b>
       <p>
       The Commercial Software screen is opened and the user can choose pay packages.
       </p>
       </li>

    </ul>

 <li><b>Main steps:</b> </li>
    <ul>
      <li>Check dependencies with every selection or deselection of a package
          and show the appropriate popups<br></li>

      <li><b>Popups informing about unresolved package dependencies</b></li>
      <ul>
      <li><u>Common description:</u><br></li>
        <p>         
	 Popups about package conflicts are shown only, if the user has ever selected
         a package in YaST2 Single Selection before (not at once when entering the dialog).
	 </p> <br>
	 <p>
	 When clicking on a line in package list, dependencies are checked BEFORE the
	 dependendies concerning the actual selection are respected.
	 </p> <br>
         <p>
	Additional needed packages (AND dependencies) are installed automatically
          without showing a popup.   
       </p>  <br>
       <li><u>Popups:</u><br>
       <p>Scenario: the user had selected some groups (Games, KDE ...), entered Single Selection and selected
        a package.</p>
	</li>
	<br><br>
	<img src="sel_conflict.png" width=365 height=250 border=0> <br><br>
	<p>
	<br> <br>
	Inform user that there are unresesolved dependencies in existing selection, not directly related
	to his actual selection.
	 </p> <br>
	 <hr>

	 <p>Button <b>Continue</b> will delete all OR and XOR dependencies (that means inform
	  YaST2 package info server to forget about it),
	  all AND dependencies will be executed (that means YaST2 will install all additional
	  needed packages).</p>

	   Button <b>Show dependencies</b> will cause more popups:
	   <br>  <br>
	   <img src="add_pkg.png" width=346 height=259 border=0>
	   <br> <br>
	   <p>Existing OR dependencies in pre-selection of groups. The user can choose an additional
	   package.<br>
	   Existing XOR dependencies (i.e. package conflicts) would be shown too (see .</p>
	   <br>
	   <hr>
	   <br>
	   After that, popups concerning the actual selection will be shown, e.g. user has
	   selected "minigcc":<br><br>
	   
	    <img src="new_conflict.png" width=339 height=294 border=0><br>

	    <hr>
	    <br><br>
	    or user has deselected an automatically needed package:<br> <br>
	    <br><br>

	    <img src="auto_conflict.png" width=351 height=179 border=0><br>

	    <hr>
    </ul>
   </ul>
   
   <br><br>
   <li><b>Actions on NEXT:</b>
         <p>
	 Returns to module <u>inst_sw_details.ycp</u>, which returns to <u>inst_sw_select.ycp</u>
	 which does the remaining work to get the install packages and write <b>install_list</b><i> 
	 to user_settings</i>  (see <a href="#Software Selection">Software Selection</a>). 
    </p>
    </li>
 <br><br>
    <li><b>Package search</b>

    <p>There is an additional button "Search" in YaST2 Single Selction.
    The user input  can be a package name, part of the name, a word from description ...<br>
    There are the possibilities to search in package (short+long) description and to ignore case.<br>
    The result is shown in package list (set "z???").<br></p>

    <img src="search.png" width=374 height=250 border=0><br><br>
    <img src="search_result.png" width=650 height=506 border=0>  <br><br>
    </li>

    <li><b>Groups tags</b>
    <p>
    Checkbox "Show group tags" is added YaST2 Software Single Selection - see picture above     <br>
    All packages are sorted on groups tags now (in addition to be sorted on package sets). <br>
    A click on the checkbox will change the list of package sets to list of group tags. If the user selects a group,
    the list of packages belonging to that group will be shown on the right. <br>

    Group tags are: Amusements/Games, Amusements/Graphics, Applications/Archiving .....  up to X11/XFree86,
     X11/XFree86/Servers.</p> <br>
   </li>

</ol>



<h3>1.2. Install additional packages/Remove packages from installation</h3>

<h4><a name="Overview installed system">1.1. Overview installed system</a></h4>

<img src="overview_installed.png">

<hr>

<p>
The diagramm shows three sections. Left side describes the <b>Source</b> i.e. where the information
about the packages and the rpm's itself comes from, e.g. CD, NFS directory.
The middle part represents <b>YaST2</b> modules involved in installation of additional packages
respectively removal of packages.
The <b>Target</b>, (the existing partition(s) on harddisk where the packages will be installed)
is shown on the right.
</p>

<h4>1.2. Description of ycp modules:</h4>

<h4><a name="Control module">Control module ( <u>sw_single.ycp</u> )</a></h4>
<ul>
    <li><b>Description:</b>
        <p>
	This module contains the control loop for the package installation workflow.
	</p>
    </li>
 <li><b>Main steps:</b></li>
    <li>Cecking the SuSE version </li>
    <li>All settings required from later called modules have to be set in <i>user_settings</i>.
    Most important settings are: 
    <b>continue_mode</b> (set to false), 
    <b>post_install</b> (set to true),
    <b>installMap</b> (information about source of installation, e.g. CD ), 
    <b>install_list</b> (information about the packages to install),  
    <b>delete_list</b> (information about the packages to delete),
    <b>targetroot</b> (the targetroot here is NOT "/mnt" but "/" because it's an installed system).     
    </li>
    <li>Call SuSEConfig to finish the installation</li>
</ul>

<h4><a name="Single post install">Single Software Selection</a></h4>

<ol>
    <li><b>Description:</b>
        <p>
	The dialog shows all packages with status information, i.e. the already installed packages are
	marked with <b>i</b>, uninstalled are unmarked. The user can select a new package for installation
	(will be marked with <b>X</b>) and delete installed packages (will be marked with <b>d</b>).
	The module is called with argument <b>`post_install</b> to indicate the use in already in installed system.
	</p>
    </li>
 <li><b>Calls of inst_sw_single:</b>
   <ul>
       <li>inst_sw_single   <b>`post_install</b>   <b>`not_only_checked</b>  <u>partition info</u>
       <p>
       Post install mode is mainly used to show different text (help text and popup texts are
       different). The third argument <u>partition info</u> contains the information about the
       available partitions (which is obtained in <a href=" "> sw_single.ycp</a> ).
       </p>
       </li>
       <li>inst_sw_single   <b>`post_install</b>    <b>`only_checked</b>  <u>partition info</u>
       <p>
       This call is used to install a list of packages NOT in usual install workflow and the module
       is only called to show unresolved dependencies und is closed automatically afterwards.
       </p>
       </li>

    </ul>

 <li><b> Main steps:</b> </li>
    <ul>
      <li>Check dependencies with every selection or deselection of a package
          and show the appropriate popups<br></li>

      <li><b>Popups informing about unresolved package dependencies</b></li>
      <ul>
      <li><u>Common description:</u><br></li>
        <p>The installation is checked when entering the dialog and unresolved dependencies
	 are shown immediately.
	</p><br>

	<p>Popups about package conflicts and additional required packages are shown. AND dependencies,
	 i.e. packages which are automatically selected for installation are shown as well.
	</p><br>

	<br>


      <li><u>Popups:</u></li><br>
      <p>Scenario: Calling "Install/Remove packages" from YaST2 Menu:</p><br>
      <img src="inst_conflict.png" width=367 height=243 border=0><br> <br>

      Inform user that there are unresolved dependencies in existing installation.

                <hr>

	<p>Button <b>Continue</b> will delete all OR and XOR dependencies (that means inform
	 YaST2 package info server to forget about it),
	  all AND dependencies will be executed (that means YaST2 will install all additional needed packages).</p>

	   Button <b>Show dependencies</b> will cause more popups:<br>  <br>
	   <img src="exist_conflict.png" width=320 height=283 border=0><br><br>
	   Inform user about unresolved package conflicts.
	   <hr>
	   <p>After showing conflict and additional required popups, the existing AND dependencies are shown: </p>
	   <img src="add_needed.png" width=291 height=211 border=0><br><br>
	   The user can decide whether to install the additional needed packages or not.
	   <hr>
    <li><u>Additional description:</u></li>
    <br> <br>
    
    <p>The dependeny checks runs again after every click on package list (every new selection of a package).<br>
    Unresolved dependencies "Additional package needed" (OR) and "Package conflict" (XOR)
    as well as "Notify" and "Warning" popups will be shown.</p><br>
    <p>Additional needed packages will be installed automatically.</p><br>
    
    </ul>
    </ul>
</ol>

<h3><a name="Single update mode">Update</a></h3>

  <b>Description:</b>
<br><br>
<ul>
<li>YaST2 Select packages tp update is called automatically, if there are packages, which require a manually decision
whether to an update or not. The user also can decide itself to take a look at all packages selected for update.</li>

<li>Three lists are available: the list with all packages for manual decision, another list contains all packages
automatically selected for update and the list with installed packages (no update).</li>
<li>If the user clicked on package in list "Manual selection", the status of the package changes to
"u", which means, update the package.<br>If user selected list "Selected for Update" he will see this package there.
Changing back to "Manual selection" shows the list without the package.  </li>
<li>Clicking on package with status "u" will change status to "i" (which means: do not update the package, let the installed one) and other way
round.</li><br>
<li>When entering dialog Select packages to update, popups about package conflicts are NOT shown immediately.
The user has the possibility to check the installation with additional Button "Check installation".</li>
<li>If the user clicked on "Check installation" popups about conflicting/missing packages as well as
automatically needed packages will be shown.</li>
<br><br>

<img src="update.png" width=650 height=506 border=0><br><br>

<hr>
<u>Popups:</u><br>
<p>ScenarioUser clicked on "Check installation"</p>
<img src="exist_conflict.png" width=320 height=283 border=0><br> <br>
<img src="add_needed.png" width=291 height=211 border=0><br>

Popups if something is unresolved.
<hr>
<p>If the user clicked again on "Check installation" the popup informs that there are no new dependencies.
That means the user has already seen existing conflicts and additional nedded packages.</p>

<img src="check_again.png" width=323 height=149 border=0><br>
<hr>
<p>If user clicked on "Check installation" and the installation contained no unresolved dependencies and there
is nothing unresolved now, the following popup will appear:</p>
<img src="ok.png" width=265 height=133 border=0> <br>
 <hr>

 <u>Additional description:</u><br> <br>
 <ul>
 <li>After selecting a package in one of the package lists, only popups about conflicting/missing packages will be shown,
 but NOT popups about additional needed packages (YaST2 will automatically install this packages).</li>
 <li>Additional needed popup only comes on demand "Check installation".</li>
 </ul>
 <br>

</ul>


</body>
</html>